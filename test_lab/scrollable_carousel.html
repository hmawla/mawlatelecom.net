<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="pragma" content="no-cache" />
    <title>Scrollable Carousel</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="scrollable_carousel.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="scrollable_carousel.js"></script>
    <script src="js/popmotion.global.min.js"></script>


</head>

<body onload="setScrollableCarouselWidth(9);">
    <br><br><br><br><br><br><br>

    <p id="Coordinator"></p>
    <p id="tester"></p>
    <div class="container" style="overflow:hidden">
        <button onclick="movePrev()">Prev</button>
        <button onclick="moveNext()">Next</button>
        <br><br><br>
        <div id="theDivv" onmousedown="" style="max-width:100%;min-width: 200px; max-height: 25%; min-height:400px; border: solid 5px black;padding:5px; overflow:hidden;">
            <div id="theDiv" style="background-color:yellow;user-select:none;width: 300px;transform: translate(-50px,0px);">
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card text-center border-primary" style="margin-bottom: 10px;border: solid 5px black;">
                    <img style="cursor: pointer;pointer-events: none;" class="card-img-top" src="samsunggalaxys9.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Galaxy S9 Plus</h5>
                        <p class="card-text">999$</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
            </div>

        </div>

    </div>

    <script>
        var newX, moveX, oldX, pos;
        var theDiv = document.getElementById('theDiv');
        var theBigDiv = document.getElementById('theDivv');
        var _window$popmotion = window.popmotion;
        var listen = _window$popmotion.listen;
        const theDivv = document.querySelector('#theDivv');
        console.log(theBigDiv.offsetWidth);
        var pointX;
        const {
            pointer
        } = window.popmotion;
        var pointerTracker;
        var tracking = false;
        const onTracking = listen(document, 'mousemove touchmove').filter(() => tracking);
        onTracking.start(attachMove);
        let startEasingPositive;
        let startEasingNegative;

        function startTracking() {
            pointerTracker = pointer()
                .start(({
                    x
                }) => pointX = x);
            pointerTracker;
            oldX = pointerTracker.x;
            tracking = true;
            document.getElementById('tester').innerHTML = tracking + '<br>' + pointX + '<BR>';;
        }

        function stopTracking() {
            tracking = false;
            pointerTracker.stop();
            console.log(pos);
            if (pos > 0) {
                easeTo(theDiv, pos, 0);
            } else if (pos < (theBigDiv.offsetWidth - 2700)) {
                easeTo(theDiv, pos, theBigDiv.offsetWidth - 2700);
            }
            document.getElementById('tester').innerHTML = tracking + '<br>' + pointX + '<BR>';
        };

        listen(theDivv, 'mousedown touchstart').start(startTracking);
        listen(document, 'mouseup touchend').start(stopTracking);

        function attachMove() {
            clearInterval(startEasingPositive);
            clearInterval(startEasingNegative);
            newX = pointX;
            var coor;
            moveX = oldX - newX;
            coor = "Position" + pos + "<br>X coords: " + newX + "<br> old x: " + oldX + "<br> Move: " + moveX + "<br> Is attached? " + tracking;
            var style = window.getComputedStyle(theDiv);
            var matrix = new WebKitCSSMatrix(style.webkitTransform);
            pos = matrix.m41;
            if (pos < 50 && pos > ((-2700 + theBigDiv.offsetWidth - 60))) {
                theDiv.style.transform = "translateX(" + (pos - moveX) + "px)";
            }

            oldX = newX;
            document.getElementById('Coordinator').innerHTML = coor;


        }

        function easeTo(theElement, initPos, toPos) {
            var easeSpeed = 2;
            var theMover = initPos;
            clearInterval(startEasingPositive);
            clearInterval(startEasingNegative);
            if (initPos - toPos > 0) {
                startEasingNegative = setInterval(function() {
                    theMover -= easeSpeed;
                    theElement.style.transform = "translateX(" + (theMover) + "px)";
                    if (theMover < toPos) {
                        pos = toPos
                        clearInterval(startEasingNegative);
                        theElement.style.transform = "translateX(" + toPos + "px)";
                    }
                }, easeSpeed * 4);
            } else {
                startEasingPositive = setInterval(function() {
                    theMover += easeSpeed;
                    theElement.style.transform = "translateX(" + (theMover) + "px)";
                    if (theMover > toPos) {
                        clearInterval(startEasingPositive);
                        pos = toPos;
                        theElement.style.transform = "translateX(" + toPos + "px)";
                    }
                }, easeSpeed * 4);
            }
        }

        function setScrollableCarouselWidth(theRightWidth) {
            theDiv.style.width = 300 * theRightWidth + "px";
        }
    </script>

</body>

</html>